---
header-includes:
   - \usepackage{amsmath}
   - \usepackage{bm}
output: pdf_document
geometry: margin=.65in
---

Michael Leibert

Math 504 

Homework 1

\ 

\begin{itemize}

\item [{\bf 2(a)}\hspace{2mm}] Let $u$ and $v$ be two column vectors with dimension $n$.  Show $u \cdot v = u^T v$.
\end{itemize}

\[  u = 
 \begin{pmatrix}
  u_{1}    \\
  u_{2}   \\
  \vdots    \\
  u_{n}  \end{pmatrix},
  \hspace{5mm}v = 
 \begin{pmatrix}
  v_{1}    \\
  v_{2}   \\
  \vdots    \\
  v_{n}  \end{pmatrix} 
  \hspace{10mm} \text{Definition: } 
    {\bf a} \cdot {\bf b} = \sum_{i=1}^n a_{i}b_{i} = a_{1}b_{1} + a_{2}b_{2} + \dots a_{n}b_{n}\]

\begin{align*}u^Tv &= \begin{pmatrix} 
  u_{1} & u_{2} = \cdots & u_{n} \end{pmatrix}
 \begin{pmatrix}
  v_{1}    \\
  v_{2}   \\
  \vdots    \\
  v_{n}  \end{pmatrix}  \\
  &= u_{1}v_{1} + u_{2}v_{2} + \dots + u_{n}v_{n} \\
  &= \sum_{i=1}^n u_{i}v_{i} \\
  &= {\bf u} \cdot {\bf v}
\end{align*}

\ 

\begin{itemize}
\item [{\bf 2(b)}\hspace{2mm}] Let $u$ be $n$ dimensional, $v$ by $n'$ dimensional.  Let $M$ be a $n \times n'$ dimensional matrix.  Show that $u \cdot Mv = \sum_{i=1}^n \sum_{j=1}^{n'} M_{ij} u_i v_j$. (Hint:  Start by noticing that the $k$th coordinate of $Mv$, $(Mv)_k$, is given by $(Mv)_k= \sum_{j=1}^n M_{kj} v_j$)
\end{itemize}

\

\[   u = 
 \begin{pmatrix}
  u_{1}    \\
  u_{2}   \\
  \vdots    \\
  u_{n}  \end{pmatrix},
  \hspace{5mm}v = 
 \begin{pmatrix}
  v_{1}    \\
  v_{2}   \\
  \vdots    \\
  v_{n'}  \end{pmatrix}, \hspace{5 mm}
M = 
 \begin{pmatrix}
  m_{1,1} & m_{1,2} & \cdots & m_{1,n'} \\
  m_{2,1} & m_{2,2} & \cdots & m_{2,n'} \\
  \vdots  & \vdots  & \ddots & \vdots  \\
  m_{n,1} & m_{n,2} & \cdots & m_{n,n'} 
 \end{pmatrix} \]
 
 \begin{align*}
u \cdot Mv &= u \cdot  \begin{pmatrix}
  m_{1,1} & m_{1,2} & \cdots & m_{1,n'} \\
  m_{2,1} & m_{2,2} & \cdots & m_{2,n'} \\
  \vdots  & \vdots  & \ddots & \vdots  \\
  m_{n,1} & m_{n,2} & \cdots & m_{n,n'} 
 \end{pmatrix} 
 \begin{pmatrix}
  v_{1}    \\
  v_{2}   \\
  \vdots    \\
  v_{n'}  \end{pmatrix} \\
  &\\
    &= u \cdot \begin{pmatrix}
  \sum\limits_{j=1}^{n'} m_{1j}v_{j}   \\
  \sum\limits_{j=1}^{n'} m_{2j}v_{j}   \\
  \vdots    \\
  \sum\limits_{j=1}^{n'} m_{nj}v_{j}  \end{pmatrix} \hspace{40 mm}
  \text{Let } \mu = \begin{pmatrix}
  \sum\limits_{j=1}^{n'} m_{1j}v_{j}   \\
  \sum\limits_{j=1}^{n'} m_{2j}v_{j}   \\
  \vdots    \\
  \sum\limits_{j=1}^{n'} m_{nj}v_{j}  \end{pmatrix} \\
  &\\
    &= {\bf u} \cdot  \bm{\mu} \\
    &= \sum\limits_{i=1}^n u_i \mu_i = 
    \sum\limits_{i=1}^n u_i \left( \sum\limits_{j=1}^{n'} m_{ij}v_{j} \right)  =
    \sum\limits_{i=1}^n \sum\limits_{j=1}^{n'} m_{ij} u_i v_{j} 
    \end{align*}


\ 

\begin{itemize}
\item [{\bf 2(c)}\hspace{2mm}] Let $b$ and $x$ be vectors in $\mathbb{R}^n$, Show that $\nabla(b^T x) = b$.  (We did this in class.)
\end{itemize}

\begin{align*}
 \nabla \left( b^T x \right) &= \nabla \left( \sum\limits_{i=1}^n b_i x_i\right) \\
 &= \nabla \left( b_1 x_1  + b_2 x_2 + \dots + b_n x_n \right) \\
 &= \begin{pmatrix} \cfrac{\partial}{\partial x_1 } \ b_1 x_1  + b_2 x_2 + \dots + b_n x_n \\
                    \cfrac{\partial}{\partial x_2 } \ b_1 x_1  + b_2 x_2 + \dots + b_n x_n \\
                    \vdots \\
                    \cfrac{\partial}{\partial x_n } \ b_1 x_1  + b_2 x_2 + \dots + b_n x_n \\
      \end{pmatrix} \\
 &= \begin{pmatrix} b_1 \\ b_2 \\ \vdots \\ b_n \end{pmatrix} \\
 &= {\bf b}          
\end{align*}

\ 

\

\begin{itemize}
\item [{\bf 2(d)}\hspace{2mm}] Let $A$ be an $n \times n$ matrix and $x \in \mathbb{R}^n$.  Show that $\nabla(x^TAx) = (A + A^T)x$.  Hint: Use (b).
\end{itemize}

 

\[ x = 
 \begin{pmatrix}
  x_{1}    \\
  x_{2}   \\
  \vdots    \\
  x_{n}  \end{pmatrix}, \hspace{5 mm}
A = 
 \begin{pmatrix}
  a_{11} & a_{12} & \cdots & a_{1n} \\
  a_{21} & a_{22} & \cdots & a_{2n} \\
  \vdots  & \vdots  & \ddots & \vdots  \\
  a_{n1} & a_{n2} & \cdots & a_{nn} 
 \end{pmatrix}, \hspace{5 mm}
A^T = 
 \begin{pmatrix}
  a_{11} & a_{21} & \cdots & a_{n1} \\
  a_{12} & a_{22} & \cdots & a_{n2} \\
  \vdots  & \vdots  & \ddots & \vdots  \\
  a_{1n} & a_{2n} & \cdots & a_{nn} 
 \end{pmatrix}\]

\begin{align*}
x^T A x &= \begin{pmatrix}  x_1 & x_2 & \cdots & x_n \end{pmatrix}
     \begin{pmatrix}
  a_{11} & a_{12} & \cdots & a_{1n} \\
  a_{21} & a_{22} & \cdots & a_{2n} \\
  \vdots  & \vdots  & \ddots & \vdots  \\
  a_{n1} & a_{n2} & \cdots & a_{nn} 
 \end{pmatrix}\begin{pmatrix}
  x_{1}    \\
  x_{2}   \\
  \vdots    \\
  x_{n}  \end{pmatrix} \\
  & \\
  &= \begin{pmatrix}  x_1 & x_2 & \cdots & x_n \end{pmatrix} 
  \begin{pmatrix}  \sum\limits_{j=1}^n a_{1j} x_j  \\ 
                    \sum\limits_{j=1}^n a_{2j} x_j  \\ 
                    \vdots \\
                     \sum\limits_{j=1}^n a_{1j} x_j \end{pmatrix} \\
  &= x_1 \sum\limits_{j=1}^n a_{1j} x_j + 
      x_2 \sum\limits_{j=1}^n a_{2j} x_j + ... + 
      x_n \sum\limits_{j=1}^n a_{nj} x_j                  
  \end{align*}


\begin{align*}
\nabla\left(x^T A x \right) &= \begin{pmatrix} \\
  \cfrac{\partial}{\partial x_1} \left[ x_1 \sum\limits_{j=1}^n a_{1j} x_j + 
      x_2 \sum\limits_{j=1}^n a_{2j} x_j + ... + 
      x_n \sum\limits_{j=1}^n a_{nj} x_j \right] \vspace{3 mm} \\
  \cfrac{\partial}{\partial x_2} \left[ x_1 \sum\limits_{j=1}^n a_{1j} x_j + 
      x_2 \sum\limits_{j=1}^n a_{2j} x_j + ... + 
      x_n \sum\limits_{j=1}^n a_{nj} x_j \right] \vspace{3 mm} \\
    \vdots \vspace{3 mm} \\
  \cfrac{\partial}{\partial x_n} \left[ x_1 \sum\limits_{j=1}^n a_{1j} x_j + 
      x_2 \sum\limits_{j=1}^n a_{2j} x_j + ... + 
      x_n \sum\limits_{j=1}^n a_{nj} x_j \right]  \vspace{4 mm} \end{pmatrix} \\
      & \\
  &= \begin{pmatrix} \\   
    2a_{11}x_1 +a_{12}x_2 + ... + a_{1n}x_n + a_{21}x_2 + ... + a_{n1}x_n  \vspace{3 mm} \\
    a_{12}x_1 + a_{21}x_1 + 2a_{22}x_2 + ... + a_{2n}x_n + ... + a_{n2}x_n  \vspace{3 mm}  \\
    \vdots \\
    a_{1n}x_1 + a_{2n}x_2 + ... + a_{n1}x_1 + a_{n2}x_2 + ... + 2a_{nn}x_n  \vspace{4 mm} \end{pmatrix} \\
  & \\
  &= \begin{pmatrix} \\   
    a_{11}x_1 +a_{12}x_2 + ... + a_{1n}x_n + a_{11}x_1 + a_{21}x_2 + ... + a_{n1}x_n  \vspace{3 mm} \\
    a_{21}x_1 + a_{22}x_2 +  ... + a_{2n}x_n  + a_{12}x_1 +  a_{22}x_2 + ...+ a_{n2}x_n  \vspace{3 mm}  \\
    \vdots \vspace{3 mm} \\
    a_{n1}x_1 + a_{n2}x_2 + ... + a_{nn}x_n + a_{1n}x_1 +  a_{2n}x_2 +... + a_{nn}x_n  \vspace{4 mm} \end{pmatrix} \\
  & \\
  &=   \begin{pmatrix} \\   
    a_{11}x_1 +a_{12}x_2 + ... + a_{1n}x_n    \vspace{3 mm} \\
    a_{21}x_1 + a_{22}x_2 +  ... + a_{2n}x_n     \vspace{3 mm}  \\
    \vdots \\
    a_{n1}x_1 + a_{n2}x_2 + ... + a_{nn}x_n   \vspace{4 mm} \end{pmatrix}+
    \begin{pmatrix} \\   
     a_{11}x_1 + a_{21}x_2 + ... + a_{n1}x_n  \vspace{3 mm} \\
    a_{12}x_1 +  a_{22}x_2 + ...+ a_{n2}x_n  \vspace{3 mm}  \\
    \vdots \\
     a_{1n}x_1 +  a_{2n}x_2 +... + a_{nn}x_n  \vspace{4 mm} \end{pmatrix} \\
  & \\
  &=  \begin{pmatrix}
  a_{11} & a_{12} & \cdots & a_{1n} \\
  a_{21} & a_{22} & \cdots & a_{2n} \\
  \vdots  & \vdots  & \ddots & \vdots  \\
  a_{n1} & a_{n2} & \cdots & a_{nn} 
 \end{pmatrix}   \begin{pmatrix}
  x_{1}    \\
  x_{2}   \\
  \vdots    \\
  x_{n}  \end{pmatrix} + \begin{pmatrix}
  a_{11} & a_{21} & \cdots & a_{n1} \\
  a_{12} & a_{22} & \cdots & a_{n2} \\
  \vdots  & \vdots  & \ddots & \vdots  \\
  a_{1n} & a_{2n} & \cdots & a_{nn} 
 \end{pmatrix}
  \begin{pmatrix}
  x_{1}    \\
  x_{2}   \\
  \vdots    \\
  x_{n}  \end{pmatrix} \\
  & \\
  &= \left( A + A^T \right) x
\end{align*}
 
\ 

\begin{itemize}
\item [{\bf 2(e)}\hspace{2mm}] Explain why a general quadratic in $\mathbb{R}^n$ can be written as $f(x) = x^T A x + b^T x + c$.  No proof here, just explain the intuition.  https://math.stackexchange.com/questions/2019154/is-the-matrix-a-symmetric-in-the-quadratic-form
\end{itemize}

??? something about symmetry

\

\

\begin{itemize}
\item [{\bf 2(f)}\hspace{2mm}] Let
\[
A = \begin{pmatrix} 
1 & 4 \\
2 & 1 
\end{pmatrix} \]
and let $f(x) = x^T A x.$  Show that $f(x)$ can be rewritten as $f(x) = x^T B x$ with $B$ symmetric.  (Hint: write out $f(x)$ as a sum of terms rather than a matrix expression.) Then explain why for the general quadratic in (e), we can always asssume that $A$ is symmetric.
\end{itemize}

\[ A = \begin{pmatrix} 1 & 4 \\ 2 & 1 \end{pmatrix}, \hspace{5 mm} 
   A^T = \begin{pmatrix} 1 & 2 \\ 4 & 1 \end{pmatrix} \]

\begin{align*}
\begin{pmatrix} x_1  & x_2 \end{pmatrix} \begin{pmatrix} 1 & 4 \\ 2 & 1 \end{pmatrix} 
  \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} 
  &= \begin{pmatrix} x_1  & x_2 \end{pmatrix}  \begin{pmatrix} x_1 +4x_2 \\ 2x_1 + x_2 \end{pmatrix} \\
  &= x_1(x_1 + 4x_2) + x_2 (2x_1 + x_2) \\
  &= x_1^2 +4x_1x_2+2x_1x_2 + x_2^2 \\
  &= x_1^2 +6x_1x_2 + x_2^2 \\
  & \\
  & \\
\begin{pmatrix} x_1  & x_2 \end{pmatrix} \begin{pmatrix} 1 & 2 \\ 4 & 1 \end{pmatrix} 
  \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} 
  &= \begin{pmatrix} x_1  & x_2 \end{pmatrix}  \begin{pmatrix} x_1 +2x_2 \\ 4x_1 + x_2 \end{pmatrix} \\
  &= x_1(x_1 + 2x_2) + x_2 (4x_1 + x_2) \\
  &= x_1^2 +2x_1x_2+4x_1x_2 + x_2^2 \\
  &= x_1^2 +6x_1x_2 + x_2^2 
\end{align*}

\

\

\begin{itemize}
\item [{\bf 2(g)}\hspace{2mm}] Let $x \in \mathbb{R}^n$ and $f(x) = x^T A x + b^T x + c$ where $A$ is an $n \times n$ matrix, $b$ is a $n$ dimensional vector and $c$ is a scalar.  Show that $\nabla f(x) = (A + A^T)x + b$.  Solve for the critical point of $f(x)$.  (We essentially did this in class.)
\end{itemize}


#3

```{r, echo=T}
library(RCurl)
dat <- getURL("https://raw.githubusercontent.com/mleibert/504/master/economic_data.txt")
dat <- read.table(text = dat ,header=T)
options(scipen = 999)

y<-dat[,ncol(dat)]
B<-as.matrix(dat[,2:(ncol(dat)-1)])
B<-cbind(1,B)

#solve(t(B) %*% B ) %*% t(B) %*% y

cor(B[,-1])
BB<-B[,-c(7,6)]
cor(BB[,-1])
solve(t(BB) %*% BB ) %*% t(BB) %*% y
```

\

??? something about multicollinearity

\

```{r}
dat<-dat[,-1]
( lm(B~.,data=dat) )
```

#4

```{r}
 times<-rep(NA,10)

for ( i in 1:10) {
  
  times[i]<-system.time( for ( j in 1:(10^i) ) { 1*1 } )[1]
  if ( times[i] > 1 ) { break}}
times

system.time( for( i in 1: (1/times[7] * 10^7) ) { 1*1} )
1/times[7] * 10^7
 
```

